<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatib le" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
        <!-- 导入 layui 的样式表 -->
        <link rel="stylesheet" type="text/css" href="http://10.168.0.218:8086/rsp-group-innovation/static/css/common.css" />
        <link rel="stylesheet" href="http://10.168.0.218:8086/rsp-group-innovation/static/lib/layui/css/layui.css" />
        <!-- 导入自己的样式表 -->
        <link rel="stylesheet" href="css/font/iconfont.css" />
        <link rel="stylesheet" href="css/runnet_common.css" />
        <link rel="stylesheet" href="css/runnet_page.css" />
        <title>众创平台</title>
        <style>
            .title {
                height: 30px;
                line-height: 30px;
                padding: 0 30px;
            }

            .section_1 .memo {
                bottom: 14px;
                font-size: 16px;
                left: 10px;
                color: #fff;
                height: 40px;
                line-height: 40px;
                padding-left: 20px;
                color: #fff;
            }
            #roll_wrap {
                overflow: hidden;
                height: 20px;
                /* width: 80%; */
                text-align: center;
                padding-left: 25px;
            }
            #roll_wrap li {
                padding-bottom: 0;
                line-height: 24px;
                text-align: left;
            }
            .msg-header .iconfont {
                position: absolute;
                left: 0;
                top: 5px;
            }
        </style>
    </head>

    <body>
        <div id="headDiv"></div>
        <div id="searchDiv"></div>

        <div class="runnet_main_body">
            <div class="wrap">
                <div class="runnut_head flex-between block p-xs">
                    <div class="relative msg-header">
                        <i class="iconfont icon-message color-theme"></i>
                        <div id="roll_wrap">
                            <div id="roll_msg_wrap"></div>
                            <div id="clone_roll_msg_wrap"></div>
                        </div>
                    </div>
                    <div>
                        <a class="link-hover" href="notifyList.html">更多 >></a>
                    </div>
                </div>

                <div class="page-nav m-b-md">
                    <i class="iconfont icon-xinwen color-icon"></i>
                    <span>新闻动态 >></span>
                </div>

                <div class="section_1">
                    <script id="newsTop_demo" type="text/html">
                        <a style="width: 800px" class="height300 block p-xs relative float-left" href="newsDetail.html?id={{d.id}}">
                            <img src="{{d.manPic}}" style="height: 100%; width: 100%" />
                            <div class="absolute memo">{{d.title}}</div>
                        </a>
                    </script>
                    <div id="newsTop_views"></div>
                    <script id="news_demo" type="text/html">
                        {{# layui.each(d , function(index, item){ }}
                        <li class="overflow-hidden p-b-sm">
                            <div class="float-left">
                                <img src="{{item.manPic}}" height="80ox;" width="100px" />
                            </div>
                            <div style="width: 240px;" class="float-right text-ellipsis-3   text-indent-2">
                                <a href="newsDetail.html?id={{item.id}}" class="link-hover">{{item.title}}</a>
                            </div>
                        </li>
                        {{# }); }}
                    </script>
                    <ul style="width: 380px" class="height300 block p-sm overflow-hidden float-right" id="news_wrap"></ul>
                </div>

                <div class="clear">
                    <div style="width: 800px" class="float-left">
                        <div class="page-nav">
                            <i class="iconfont icon-zhengce color-icon"></i>
                            <span>政策宣讲 >></span>
                        </div>
                        <script id="policy_demo" type="text/html">
                            {{# layui.each(d, function(index, item){ }}
                            <li class="flex-between p-b-md">
                                <a href="newsDetail.html?id={{item.id}}" class="text-ellipsis-1 link-hover" style="width: 60%;">{{item.title}}</a>
                                <a href="newsDetail.html?id={{item.id}}">{{item.viceTitle}}</a>
                            </li>
                            {{# }); }}
                        </script>
                        <ul class="block height300 p-md" id="policy_wrap"></ul>
                    </div>
                    <div style="width: 380px" class="float-right">
                        <div class="page-nav">
                            <i class="iconfont icon-tongzhi color-icon"></i>
                            <span><a class="link-hover" href="notifyList.html">通知公告 >></a></span>
                        </div>
                        <script id="notify_demo" type="text/html">
                            {{# layui.each(d, function(index, item){ }}
                            <li class="p-b-md text-ellipsis-1 link-hover" id="{{item.id}}" onclick="toNotifyDetail(this)">{{item.title}}</li>
                            {{# }); }}
                        </script>
                        <ul class="block height300 p-md" id="notify-wrap"></ul>
                    </div>
                </div>
                <div class="page-nav clear">
                    <i class="iconfont icon-chengjiu color-icon"></i>
                    <span>成果展示 >></span>
                </div>
                <ul class="block p-md">
                    <li class="overflow-hidden p-b-md">
                        <div class="float-left img-box" style="height: 100px; width: 150px">
                            <img src="images/crowdCreate/2.png" />
                        </div>
                        <div class="text-indent-2 float-right" style="width: 1000px">
                            a重庆气象部门多个智慧气象发展成果亮相本次展会，吸引众多观众驻足观看。本次博览会为期4天，主题是“智能化：为经济赋能，为生活添彩”，将突出国际化、专业性、体验感，向广大企业和观众展示新技术、新动能、新前景。
                        </div>
                    </li>
                    <li class="overflow-hidden p-b-md">
                        <div class="float-left img-box" style="height: 100px; width: 150px">
                            <img src="images/crowdCreate/3.png" />
                        </div>
                        <div class="text-indent-2 float-right" style="width: 1000px">
                            a重庆气象部门多个智慧气象发展成果亮相本次展会，吸引众多观众驻足观看。本次博览会为期4天，主题是“智能化：为经济赋能，为生活添彩”，将突出国际化、专业性、体验感，向广大企业和观众展示新技术、新动能、新前景。
                        </div>
                    </li>
                    <li class="overflow-hidden p-b-md">
                        <div class="float-left img-box" style="height: 100px; width: 150px">
                            <img src="images/crowdCreate/4.png" />
                        </div>
                        <div class="text-indent-2 float-right" style="width: 1000px">
                            a重庆气象部门多个智慧气象发展成果亮相本次展会，吸引众多观众驻足观看。本次博览会为期4天，主题是“智能化：为经济赋能，为生活添彩”，将突出国际化、专业性、体验感，向广大企业和观众展示新技术、新动能、新前景。
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
<script type="text/javascript" src="http://10.168.0.218:8086/rsp-group-innovation/static/lib/jquery.js"></script>
<script type="text/javascript" src="http://10.168.0.218:8086/rsp-group-innovation/static/js/common.js"></script>
<script type="text/javascript" src="http://10.168.0.218:8086/rsp-group-innovation/static/lib/layui/layui.all.js"></script>
<script type="text/javascript" src="js/base.js"></script>
<script type="text/javascript">
    // var newsLists = [
    //     '"4月19日，“科创中国”咨询委员会第一次全体会议在京召开"',
    //     '"科创中国”在行动——山东省日照市2021年中国科协专利信息平台应用培训会举办"',
    //     '"山东省科协党组深入学习习近平总书记在庆祝中国共产党成立95周年大会上的讲话"',
    //     '4月20日，中国科技期刊卓越行动计划工作交流推进会在京召开。中国科协党组书记、常务副主席、书记处第一书记怀进鹏院士，世界一流科技期刊建设专家委员会主任杨卫院士出席会议并致辞，',
    // ];


    layui.use(['laytpl'], function () {
        var laytpl = layui.laytpl

        var notifyTpl = notify_demo.innerHTML,
            policyTpl = policy_demo.innerHTML,
            newsTpl = news_demo.innerHTML,
            newsTopTpl = newsTop_demo.innerHTML
        var notifyView = document.getElementById('notify-wrap'),
            policyView = document.getElementById('policy_wrap'),
            newsView = document.getElementById('news_wrap'),
            rollMsgView = document.getElementById('roll_msg_wrap')
            newsTopViews = document.getElementById('newsTop_views')

        var renderNotify = function (v) {
            laytpl(notifyTpl).render(v, function (html) {
                notifyView.innerHTML = html
                rollMsgView.innerHTML = html
            })
        }
        $.ajax({
            type: 'post',
            url: baseUrl + '/notice/pageList',
            contentType: 'application/json;charset=UTF-8',
            data: JSON.stringify({ page: 1, limit: 7 }),
            success: function (res) {
                if (res.code == 200) {
                    notifys = res.data.data
                    renderNotify(res.data.data)
                    showAnimation()
                }
            },
        })

        var renderPolicy = function(v){
            laytpl(policyTpl).render(v, function (html) {
                policyView.innerHTML = html
            })
        }
        $.ajax({
            type: 'post',
            url: baseUrl + '/news/queryList',
            contentType: 'application/json;charset=UTF-8',
            data: JSON.stringify({ page: 1, limit: 5,type:"2" }),
            success: function (res) {
                if (res.code == 200) {
                    renderPolicy(res.data.data)
                }
            },
        })

        var renderNews = function (v) {
            laytpl(newsTpl).render(v, function (html) {
                newsView.innerHTML = html
            })
        }
        var renderNewsTop = function (v) {
            laytpl(newsTopTpl).render(v, function (html) {
                newsTopViews.innerHTML = html
            })
        }
        $.ajax({
            type: 'post',
            url: baseUrl + '/news/queryList',
            contentType: 'application/json;charset=UTF-8',
            data: JSON.stringify({ page: 1, limit: 5,type:"1" }),
            success: function (res) {
                if (res.code == 200) {
                    var objArr = res.data.data;
                    var has = true;
                    var tempArr = new Array();
                    var tempTopArr = {};
                    if(objArr.length>0){
                        for(var i=0;i<objArr.length;i++){
                            if(objArr[i].istop == "1" && has){
                                objArr[i].manPic = imageUrl+objArr[i].manPic;
                                tempTopArr = objArr[i];
                                has = false;
                            }else{
                                objArr[i].manPic = imageUrl+objArr[i].manPic;
                                tempArr.push(objArr[i]);
                            }
                        }
                        renderNewsTop(tempTopArr);
                        renderNews(tempArr);
                    }
                }
            },
        })
    })

    function showAnimation() {
        var speed = 80 // 可自行设置文字滚动的速度

        var wrapper = document.getElementById('roll_wrap'),
            demo1 = document.getElementById('roll_msg_wrap'),
            demo2 = document.getElementById('clone_roll_msg_wrap')
        demo2.innerHTML = demo1.innerHTML //克隆demo1为demo2
        var Marquee = function () {
            if (demo2.offsetHeight - wrapper.scrollTop <= 0)
                //当滚动至demo1与demo2交界时
                wrapper.scrollTop -= demo1.offsetHeight
            //demo跳到最顶端
            else {
                wrapper.scrollTop++
            }
        }
        var MyMar = setInterval(Marquee, speed) //设置定时器
        wrapper.onmouseover = function () {
            clearInterval(MyMar)
        } //鼠标移上时清除定时器达到滚动停止的目的

        wrapper.onmouseout = function () {
            MyMar = setInterval(Marquee, speed)
        } //鼠标移开时重设定时器
    }
    function toNotifyDetail(target) {
        sessionStorage.setItem('notifyId', $(target).attr('id'))
        window.location.href = 'notifyDetail.html'
    }
</script>
