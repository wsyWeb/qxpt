<link rel="stylesheet" href="lib/layui/css/layui.css" />
<link rel="stylesheet" href="css/runnet_common.css" />
<link rel="stylesheet" href="css/runnet_page.css" />
<link rel="stylesheet" href="css/font/iconfont.css" />
<style>
    /* .register_expert_form .layui-input,
    .register_expert_form .layui-textarea,
    .register_expert_form .layui-input:hover,
    .register_expert_form .layui-input:focus,
    .register_expert_form .layui-textarea:hover,
    .register_expert_form .layui-textarea:focus {
        border-color: transparent !important;
    } */
    .register_expert_form .basic-info .layui-form-label,
    .commnt .layui-form-label {
        text-align: right;
        text-align-last: justify;
    }
    .commnt .layui-form-label {
        color: #2a6be3;
        font-weight: bold;
    }
    .register_expert_form .layui-input-block,
    .commnt .layui-input-block {
        margin-right: 20px;
        margin-left: 80px;
    }
    .basic-info .right .iconfont {
        font-size: 100px;
        color: #ddd;
        border: 1px solid #dedede;
        padding: 10px 0px;
    }
    .none {
        display: none;
    }
    .defaultExpertParams .layui-form-label {
        display: block;
        width: 100%;
        text-align: left;
    }
    .defaultExpertParams .layui-input-block {
        margin-left: 0;
    }
    /* #headPortrait-img {
        borde: 1px solid #dedede;
    } */
</style>
<form class="layui-form p-md register_expert_form" action="" lay-filter="register_expert_form">
    <div class="m-b-sm font-15 font-bold color-theme tips-title relative">平台信息</div>
    <div class="layui-row basic-info">
        <div class="layui-col-md10 left">
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">姓名</label>
                <div class="layui-input-block">
                    <input type="text" name="name" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                    <input type="text" name="gender" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">出生日期</label>
                <div class="layui-input-block">
                    <input name="birthDay" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">政治面貌</label>
                <div class="layui-input-block">
                    <input name="politis" readonly class="layui-input" />
                </div>
            </div>

            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">工作单位</label>
                <div class="layui-input-block">
                    <input name="workUnit" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">参工时间</label>
                <div class="layui-input-block">
                    <input name="workingTime" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">岗位级别</label>
                <div class="layui-input-block">
                    <input name="positionLevel" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">从事专业</label>
                <div class="layui-input-block">
                    <input name="professional" readonly class="layui-input" />
                </div>
            </div>

            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">职称</label>
                <div class="layui-input-block">
                    <input name="positionTitle" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">职务</label>
                <div class="layui-input-block">
                    <input name="positionJob" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">毕业学校</label>
                <div class="layui-input-block">
                    <input name="graduateSchool" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">最高学历</label>
                <div class="layui-input-block">
                    <input name="highestEducation" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">电子邮箱</label>
                <div class="layui-input-block">
                    <input name="email" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">手机号</label>
                <div class="layui-input-block">
                    <input name="mobilePhone" readonly class="layui-input" />
                </div>
            </div>

            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">通讯地址</label>
                <div class="layui-input-block">
                    <input name="postalAddress" readonly class="layui-input" />
                </div>
            </div>
            <div class="layui-col-md4 m-b-sm">
                <label class="layui-form-label">入驻领域</label>
                <div class="layui-input-block">
                    <input name="entryField" readonly class="layui-input" />
                </div>
            </div>
        </div>
        <div class="layui-col-md2 right text-right">
            <i class="iconfont icon-morentouxiang default-headPortrait"></i>
            <img id="headPortrait-img" class="none" width="100px" height="120px" />
        </div>
    </div>
    <div class="m-t-md m-b-sm font-15 font-bold color-theme tips-title relative">个人经验</div>
    <div class="defaultExpertParams"></div>
</form>
<div class="commnt-wrap commnt p-l-md p-r-md m-b-md">
    <!-- <div>参考评分标准</div> -->
    <div class="border p-b-md p-t-md">
        <div class="layui-form-item score-wrap">
            <label class="layui-form-label required">评分</label>
            <div class="layui-input-block">
                <input name="score" type="number" placeholder="请打分" class="layui-input comment-input" lay-verify="required" />
            </div>
        </div>
        <div>
            <label class="layui-form-label required">评价</label>
            <div class="layui-input-block">
                <textarea
                    name="evaluate"
                    placeholder="请输入评价，限500字"
                    maxlength="500"
                    class="layui-textarea comment-input"
                    lay-verify="required"
                ></textarea>
            </div>
        </div>
    </div>
</div>
<script src="lib/jquery.js"></script>
<script src="lib/layui/layui.all.js"></script>
<script src="js/base.js"></script>
<script>
    var index = parent.layer.getFrameIndex(window.name)
    var formData = {}
    function child(v) {
        $.get(baseUrl + '/expert/queryExpertByUserId?user_name=' + v.userName, function (res) {
            if (res.code == 200) {
                formData = res.data
                setDefaultValue()
            }
        })
    }
    function setDefaultValue() {
        if (formData.headPortrait) {
            $('.default-headPortrait').hide()
            document.getElementById('headPortrait-img').setAttribute('src', imageUrl + formData.headPortrait)
            $('#headPortrait-img').show()
        }

        if (formData.examineStatus == 1) {
            $('.commnt-wrap').find('input').attr('readonly', true)
            $('.commnt-wrap').find('textarea').attr('readonly', true)
            $('.scoreCondition').hide()
        }
        for (var i = 0; i < formData.dataArr.length; i++) {
            if (!!formData.dataArr[i].value || Number(formData.dataArr[i].disable) === 1) {
                $('.defaultExpertParams').append(
                    '<div class="layui-form-item" disable="' +
                        formData.dataArr[i].disable +
                        '">' +
                        '<label class="layui-form-label"> ' +
                        formData.dataArr[i].title +
                        '</label>' +
                        '<div class="layui-input-block"><textarea readonly class="layui-textarea content">' +
                        formData.dataArr[i].value +
                        '</textarea></div>' +
                        '</div>'
                )
            }
        }
        var node = $('.layui-form-item[disable="1"]').find('.layui-input-block') //获取单位节点
        node.empty()
        for (var i = 0; i < formData.resumeAddressArr.length; i++) {
            var item = formData.resumeAddressArr[i]
            node.append(
                '<div class="p-b-md p-t-sm"><a class="color-theme" target="_blak" href=' +
                    imageUrl +
                    item.newFileName +
                    '>' +
                    item.oldFileName +
                    '</a></div>'
            )
        }
        layui.use(['form', 'layer'], function () {
            var form = layui.form //只有执行了这一步，部分表单元素才会自动修饰成功
            // 获取父页面传参
            form.val('register_expert_form', {
                id: formData.id,
                userName: formData.userName,
                name: formData.name,
                headPortrait: formData.headPortrait,
                birthDay: formData.birthDay,
                gender: formData.gender,
                politis: formData.politis,
                workUnit: formData.workUnit,
                workingTime: formData.workingTime,
                positionLevel: formData.positionLevel,
                professional: formData.professional,
                graduateSchool: formData.graduateSchool,
                highestEducation: formData.highestEducation,
                positionTitle: formData.positionTitle,
                eamil: formData.eamil,
                mobilePhone: formData.mobilePhone,
                positionJob: formData.positionJob,
                postalAddress: formData.postalAddress,
                abroadGroup: formData.abroadGroup,
                threeYearsActivity: formData.threeYearsActivity,
                threeYearsReward: formData.threeYearsReward,
                majorMajors: formData.majorMajors,
                publishPaper: formData.publishPaper,
                acquirePatent: formData.acquirePatent,
                sceneOperation: formData.sceneOperation,
                entryField: formData.entryField,
                scorereadonly: formData.score,
                evaluatereadonly: formData.evaluate,
            })

            $('input[name="score"]').val(formData.score)
            $('textarea[name="evaluate"]').val(formData.evaluate)
        })
    }

    function closeFun() {
        parent.layer.close(index)
    }
    function callbackdata() {
        var score = $("input[name='score']").val()
        var evaluate = $("textarea[name='evaluate']").val()
        if (!score || !evaluate) {
            parent.layer.msg('带*是必填项')
            return false
        }
        if (Math.abs(score) > 100) {
            parent.layer.msg('评分不能超过100')
            return false
        }
        var submitForm = {
            score,
            evaluate,
            user_name: sessionStorage.getItem('token'),
            id: formData.id,
        }
        return submitForm
    }
</script>
